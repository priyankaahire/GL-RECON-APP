<div class="container">
  <div class="form-container">
    <form class="recon-form" [formGroup]="form">
     
      <section>
        <h3>Create Recon</h3>
        <span>User can create new Recons from here</span>
      </section>
       <!-- Section 1: Recon Name -->
      <section>
        <div class="form-row">
          <mat-form-field appearance="fill" class="recon-full-width custom-form-field">
            <mat-label>Recon Name</mat-label>
            <input matInput formControlName="reconName" maxlength="255"/>
            <div *ngIf="form.controls['reconName'].invalid && form.controls['reconName'].touched">
              <mat-error *ngIf="form.controls['reconName'].errors?.['required']">Recon Name is required</mat-error>
              <mat-error *ngIf="form.controls['reconName'].errors?.['specialCharacters']">No special characters allowed except hyphen (-)</mat-error>
              <mat-error *ngIf="form.controls['reconName'].errors?.['maxlength']">Maximum length of 255 characters exceeded</mat-error>
            </div>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width custom-form-field">
            <mat-label>Frequency</mat-label>
            <mat-select formControlName="frequency">
              <mat-option
                *ngFor="let frequency of frequencies"
                [value]="frequency?.id"
              >
                {{ frequency?.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['frequency'].invalid">
              Frequency is required
            </mat-error>
          </mat-form-field>
        </div>
      </section>
      <!-- Section 2: Source Table -->
      <section>
        <div class="table-header">
          <span>Source Table</span>
          <mat-icon class="info-icon">info</mat-icon>
        </div>
        
        <div class="form-row">
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Database</mat-label>
            <mat-select formControlName="sourcedb">
              <mat-option
                *ngFor="let db of databases.source.db "
                [value]="db.id"
              >
                {{ db.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('sourcedb')?.hasError('required')">
              Source database is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Schema</mat-label>
            <mat-select formControlName="sourceschema">
              <mat-option
                *ngFor="let schema of databases.source.schema"
                [value]="schema.id"
              >
                {{ schema.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('sourceschema')?.hasError('required')">
              Source schema is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Table</mat-label>
            <mat-select formControlName="sourcetable">
              <mat-option
                *ngFor="let tb of databases.source.table"
                [value]="tb.id"
              >
                {{ tb.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['sourcetable']?.hasError('required')">
              Source table is required
            </mat-error>
          </mat-form-field>
        </div>
      </section>
       <!-- Section 2: Target Table -->
        <section>
        <div class="table-header">
          <span>Target Table</span>
          <mat-icon class="info-icon">info</mat-icon>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="recon-full-width custom-form-field">
            <mat-label>Database</mat-label>
            <mat-select formControlName="targetdb">
              <mat-option
                *ngFor="let db of databases.target.db"
                [value]="db.id"
              >
                {{ db.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['targetdb']?.hasError('required')">
              Source database is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Schema</mat-label>
            <mat-select formControlName="targetschema">
              <mat-option
                *ngFor="let schema of databases.target.schema"
                [value]="schema.id"
              >
                {{ schema.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['targetschema']?.hasError('required')">
              Source schema is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Table</mat-label>
            <mat-select formControlName="targettable">
              <mat-option
                *ngFor="let target of databases.target.table"
                [value]="target.id"
              >
                {{ target.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['targettable']?.hasError('required')">
              Source table is required
            </mat-error>
          </mat-form-field>
        </div>
      </section>
      <!-- Section 2: Variance Table -->
      <section>
        <div class="table-header">
          <span>Variance Table</span>
          <mat-icon class="info-icon">info</mat-icon>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Database</mat-label>
            <mat-select formControlName="variancedb">
              <mat-option
                *ngFor="let db of databases.variance.db"
                [value]="db.id"
              >
                {{ db.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['variancedb']?.hasError('required')">
              Variance database is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Schema</mat-label>
            <mat-select formControlName="varianceschema">
              <mat-option
                *ngFor="let schema of databases.variance.schema"
                [value]="schema.id"
              >
                {{ schema.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['varianceschema']?.hasError('required')">
              Variance schema is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Table</mat-label>
            <mat-select formControlName="variancetable">
              <mat-option
                *ngFor="let table of databases.variance.table"
                [value]="table.id"
              >
                {{ table.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['variancetable']?.hasError('required')">
              Variance table is required
            </mat-error>
          </mat-form-field>
        </div>
      </section>
       <!-- Section 2: Adjustment Table -->
       <section>
        <div class="table-header">
          <span>Adjustment Table</span>
          <mat-icon class="info-icon">info</mat-icon>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Database</mat-label>
            <mat-select formControlName="adjustdb">
              <mat-option
                *ngFor="let db of databases.adjustment.db"
                [value]="db.id"
              >
                {{ db.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['adjustdb']?.hasError('required')">
              Adjustment database is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Schema</mat-label>
            <mat-select formControlName="adjustschema">
              <mat-option
                *ngFor="let schema of databases.adjustment.schema"
                [value]="schema.id"
              >
                {{ schema.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['adjustschema']?.hasError('required')">
              Adjustment schema is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Table</mat-label>
            <mat-select formControlName="adjusttb">
              <mat-option
                *ngFor="let table of databases.adjustment.table"
                [value]="table.id"
              >
                {{ table.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['adjusttb']?.hasError('required')">
              Adjustment table is required
            </mat-error>
          </mat-form-field>
        </div>
       </section>
      <!-- Section 4: filter -->
      <section>
        <div class="form-row">
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Source Filter Flag</mat-label>
            <mat-select formControlName="sourcefiltflag">
              <mat-option
                *ngFor="let fil of filterFlagOptions.source"
                [value]="fil.id"
              >
                {{ fil.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['sourcefiltflag']?.hasError('required')">
             Source filter flag is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill" class="recon-full-width">
            <mat-label>Target Filter Flag</mat-label>
            <mat-select formControlName="targetfiltflag">
              <mat-option
                *ngFor="let fil of filterFlagOptions.target"
                [value]="fil.id"
              >
                {{ fil.value }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.controls['targetfiltflag']?.hasError('required')">
              Source filter flag is required
            </mat-error>
          </mat-form-field>
         
        </div>
      </section>
      <!-- Section 3: Buttons -->
      <section>
        <div class="form-button-row">
          <button mat-raised-button type="cancel" (click)="cancelRecon()">Cancel</button>
          <button  color="primary" mat-raised-button (click)="saveRecon()">Next</button>
        </div>
      </section>
    </form>
  </div>
</div>
